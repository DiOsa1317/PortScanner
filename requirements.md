Домашка №3
Дедлайн: 27 ноября 23:59 (две недели)

Вам нужно реализовать сканер TCP- и UDP-портов. Утилита должна запускаться следующим образом:
portscan [OPTIONS] IP_ADDRESS [{tcp|udp}[/[PORT|PORT-PORT],...]]...
Например,
portscan -v 1.1.1.1 tcp/80 tcp/12000-12500 udp/3000-3100,3200,3300-4000
Должны поддерживаться следующие опции ([OPTIONS]):

1. --timeout — таймаут ожидания ответа (по умолчанию 2 секунды),
2. -j NUMBER или --num-threads NUMBER — число потоков (в случае многопоточной реализации),
3. -v или --verbose — подробный режим,
4. -g или --guess — определение протокола прикладного уровня.
Примеры указания диапазона портов:
portscan 1.1.1.1 tcp/80 tcp/12000-12500 udp/3000-3100,3200,3300-4000
portscan 1.1.1.1 tcp udp/40000
В ответ утилита должна выдавать список открытых портов согласно переданному списку в формате:
TCP|UDP PORT [TIME,ms] [PROTOCOL|-]
Если задана опция -v, вывод должен содержать колонку [TIME,ms] с временем получения ответа.

Если задана опция -g, вывод должен содержать колонку с названием протокола прикладного уровня. Должно поддерживаться определение следующих протоколов:
HTTP
DNS
ECHO
Сканирование TCP должно выполняться без полной установки соединения (или нет, но с потерей баллов :))

Оценивание
Всего баллов: 20

1. [5 баллов] UDP-сканирование
2. [до 6 баллов] TCP-сканирование, варианты:
   * [6] TCP SYN с ручным формированием пакетов
   * [4] TCP SYN с формированием пакетов с использованием scapy
   * [2] полная установка соединения TCP (создаётся сокет и далее .connect)
3. [до 4 баллов] Распараллеливание, варианты:
   * [2] многопоточность
   * [4] select/poll/epoll
4. [до 5 баллов] Дополнительные фичи (суммируются):
   * [2] подробный режим
   * [3] определение протокола (по 1 баллу за каждый протокол)
   * что-нибудь ещё

Штрафы за неполную реализацию:
   * [-2] неверная обработка параметров запуска
   * [-2] оставленные полуоткрытые TCP-соединения
   * [-2] несоблюдение формата вывода (в том числе оставленный мусор)